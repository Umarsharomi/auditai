<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flash Loan Attacks Explained — AuditAI Blog</title>
<meta name="description" content="Flash loans enable uncollateralized borrowing in a single transaction. Learn how attackers weaponize them to drain DeFi protocols.">
<meta name="keywords" content="flash loan attack, DeFi exploit, price oracle manipulation, smart contract security, flash loan vulnerability">
<style>
  @import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;700;800&display=swap');
  :root{--bg:#050A0E;--surface:#0C1419;--surface2:#111D24;--border:#1A2A35;--accent:#00FF88;--accent2:#00C4FF;--danger:#FF4560;--warn:#FFB800;--purple:#A855F7;--text:#E0EEF5;--muted:#4A6070;--font-display:'Syne',sans-serif;--font-mono:'Space Mono',monospace}
  *{margin:0;padding:0;box-sizing:border-box} body{background:var(--bg);color:var(--text);font-family:var(--font-mono);overflow-x:hidden;line-height:1.8}
  body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(0,255,136,0.02) 1px,transparent 1px),linear-gradient(90deg,rgba(0,255,136,0.02) 1px,transparent 1px);background-size:40px 40px;pointer-events:none;z-index:0}
  .container{max-width:720px;margin:0 auto;padding:0 24px;position:relative;z-index:1}
  nav{padding:20px 0;border-bottom:1px solid var(--border);margin-bottom:48px}
  .nav-inner{display:flex;align-items:center;justify-content:space-between}
  .nav-logo{display:flex;align-items:center;gap:10px;text-decoration:none}
  .nav-logo-icon{width:28px;height:28px;display:flex;align-items:center;justify-content:center;font-size:13px;color:var(--accent);clip-path:polygon(50% 0%,100% 25%,100% 75%,50% 100%,0% 75%,0% 25%);background:rgba(0,255,136,0.08);border:1px solid rgba(0,255,136,0.3)}
  .nav-logo-text{font-family:var(--font-display);font-size:17px;font-weight:800;color:var(--text)} .nav-logo-text span{color:var(--accent)}
  .nav-cta{padding:6px 14px;background:var(--accent);color:var(--bg);font-family:var(--font-mono);font-size:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;text-decoration:none}
  .article-tag{font-size:10px;letter-spacing:2px;text-transform:uppercase;color:var(--purple);margin-bottom:14px}
  .article-title{font-family:var(--font-display);font-size:clamp(26px,5vw,42px);font-weight:800;letter-spacing:-1px;line-height:1.1;margin-bottom:16px}
  .article-meta{display:flex;gap:16px;font-size:10px;color:var(--muted);margin-bottom:40px;padding-bottom:24px;border-bottom:1px solid var(--border)}
  h2{font-family:var(--font-display);font-size:22px;font-weight:700;margin:40px 0 16px;color:var(--purple)}
  p{font-size:13px;color:var(--muted);line-height:1.9;margin-bottom:16px} strong{color:var(--text)}
  .code-block{background:var(--surface);border:1px solid var(--border);border-left:3px solid;padding:20px;margin:20px 0;font-size:12px;overflow-x:auto;white-space:pre}
  .code-block.bad{border-left-color:var(--danger);color:var(--danger)}
  .code-block.good{border-left-color:var(--accent);color:var(--accent)}
  .code-label{font-size:9px;letter-spacing:2px;text-transform:uppercase;margin-bottom:8px}
  .code-label.bad{color:var(--danger)} .code-label.good{color:var(--accent)}
  .callout{background:var(--surface2);border:1px solid var(--border);border-left:3px solid var(--warn);padding:16px 20px;margin:20px 0;font-size:12px;color:var(--text);line-height:1.8} .callout strong{color:var(--warn)}
  .steps{display:grid;gap:2px;margin:20px 0}
  .step{background:var(--surface);border:1px solid var(--border);padding:14px 16px;display:flex;gap:14px;align-items:flex-start}
  .step-num{font-family:var(--font-display);font-size:20px;font-weight:800;color:var(--purple);flex-shrink:0;line-height:1;margin-top:2px}
  .step-content{flex:1}
  .step-title{font-family:var(--font-display);font-size:13px;font-weight:700;margin-bottom:4px}
  .step-desc{font-size:12px;color:var(--muted);line-height:1.7}
  .audit-cta{background:var(--surface);border:1px solid var(--accent);padding:28px;text-align:center;margin:48px 0}
  .audit-cta-title{font-family:var(--font-display);font-size:20px;font-weight:700;margin-bottom:8px}
  .audit-cta-sub{color:var(--muted);font-size:12px;margin-bottom:20px;line-height:1.8}
  .audit-cta-btn{display:inline-block;padding:11px 28px;background:var(--accent);color:var(--bg);font-family:var(--font-display);font-size:13px;font-weight:700;letter-spacing:1px;text-decoration:none;text-transform:uppercase}
  footer{border-top:1px solid var(--border);padding:28px 0;text-align:center;color:var(--muted);font-size:10px;margin-top:60px}
</style>
</head>
<body>
<div class="container">
  <nav><div class="nav-inner">
    <a href="/" class="nav-logo"><div class="nav-logo-icon">⬡</div><div class="nav-logo-text">Audit<span>AI</span></div></a>
    <a href="/app.html" class="nav-cta">Free Audit →</a>
  </div></nav>

  <article>
    <div class="article-tag">Attack Vectors</div>
    <h1 class="article-title">Flash Loan Attacks Explained: How $100M Was Stolen in Minutes</h1>
    <div class="article-meta"><span>9 min read</span><span>Advanced</span><span>Updated 2025</span></div>

    <p>Flash loans are one of DeFi's most powerful primitives — and its most dangerous attack vector. They allow anyone to borrow <strong>any amount of capital with zero collateral</strong>, use it within a single transaction, and return it — all in one atomic operation.</p>
    <p>When used correctly, they enable arbitrage, liquidations, and collateral swaps. When weaponized, they've been used to drain over <strong>$100 million from DeFi protocols</strong> in single transactions.</p>

    <h2>How Flash Loans Work</h2>
    <p>A flash loan is a loan that must be borrowed and repaid within a single Ethereum transaction. If the loan isn't repaid by the end of the transaction, the entire thing reverts — as if it never happened. This makes them risk-free for the lender.</p>

    <div class="steps">
      <div class="step"><div class="step-num">1</div><div class="step-content"><div class="step-title">Borrow</div><div class="step-desc">Attacker borrows $100M USDC from Aave with no collateral in one transaction.</div></div></div>
      <div class="step"><div class="step-num">2</div><div class="step-content"><div class="step-title">Manipulate</div><div class="step-desc">Uses the $100M to manipulate a price oracle, token price, or liquidity pool.</div></div></div>
      <div class="step"><div class="step-num">3</div><div class="step-content"><div class="step-title">Exploit</div><div class="step-desc">Calls the vulnerable protocol while the price is manipulated to drain funds.</div></div></div>
      <div class="step"><div class="step-num">4</div><div class="step-content"><div class="step-title">Repay</div><div class="step-desc">Repays the $100M flash loan + fee, keeps the stolen funds. All in one transaction.</div></div></div>
    </div>

    <h2>The Most Common Attack: Price Oracle Manipulation</h2>
    <p>The most common flash loan attack targets protocols that use <strong>spot prices from DEX pools as oracles</strong>. Since a flash loan can temporarily move pool prices significantly, an attacker can trick the protocol into thinking an asset is worth far more or less than it is.</p>

    <div class="code-label bad">❌ Vulnerable: Using spot DEX price as oracle</div>
    <div class="code-block bad">function getPrice(address token) public view returns (uint256) {
    // DANGEROUS: spot price can be manipulated with flash loans
    (uint112 reserve0, uint112 reserve1,) = uniswapPair.getReserves();
    return (reserve1 * 1e18) / reserve0;
}

function borrow(address token, uint256 amount) public {
    uint256 price = getPrice(token); // Manipulated price!
    uint256 collateralRequired = amount * price / 1e18;
    require(collateral[msg.sender] >= collateralRequired);
    // Attacker can borrow way more than they should
}</div>

    <div class="code-label good">✅ Safe: Use Chainlink or TWAP oracle</div>
    <div class="code-block good">import "@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol";

AggregatorV3Interface priceFeed;

function getPrice() public view returns (uint256) {
    (, int256 price,,,) = priceFeed.latestRoundData();
    return uint256(price); // Chainlink: manipulation-resistant
}

// Or use Uniswap V3 TWAP (time-weighted average price)
// TWAP is averaged over time, making flash loan manipulation too expensive</div>

    <h2>How to Protect Your Protocol</h2>
    <p><strong>1. Never use spot prices as oracles</strong> — Use Chainlink price feeds or TWAP oracles that average prices over time. Flash loans can't manipulate time-averaged prices economically.</p>
    <p><strong>2. Use internal accounting</strong> — Don't rely on address(this).balance or token.balanceOf(address(this)) for security logic. These can be manipulated. Use internal tracked balances instead.</p>
    <p><strong>3. Add reentrancy guards</strong> — Flash loan attacks often involve multiple contract calls. ReentrancyGuard can break the attack chain.</p>
    <p><strong>4. Limit single-block actions</strong> — Require multiple blocks between borrow and liquidation for lending protocols, making flash loan attacks impossible.</p>

    <div class="callout"><strong>Real examples:</strong> Beanstalk ($182M), Euler Finance ($197M), Cream Finance ($130M) — all flash loan attacks exploiting price oracle manipulation or reentrancy in DeFi protocols.</div>

    <div class="audit-cta">
      <div class="audit-cta-title">Check your protocol for flash loan vulnerabilities</div>
      <div class="audit-cta-sub">AuditAI scans for oracle dependencies, reentrancy, and other flash loan attack surfaces. Free for any Solidity contract.</div>
      <a href="/app.html" class="audit-cta-btn">⬡ Run Free Audit</a>
    </div>
  </article>
</div>
<footer>AuditAI · <a href="/blog.html" style="color:var(--accent);text-decoration:none">← Back to Blog</a></footer>
<script defer src="/_vercel/insights/script.js"></script>
</body>
</html>
